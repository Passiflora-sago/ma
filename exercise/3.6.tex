\section{习题 3.6}

\begin{exercise}[3.6.1]
    写出下列函数的（具有 Peano 余项的）Maclaurin 展开式.
    \begin{tasks}(2)
        \task $y = \frac{x^3 + 2x + 1}{x - 1}$;
        \task $y = \sin^2 x$.
    \end{tasks}
\end{exercise}

\begin{solution}
    \begin{enumerate}
        \item \begin{align*}
                  y = \frac{x^3 + 2x + 1}{x - 1} & = -(x^3 + 2x + 1)(1 + x + x^2 + \dots + x^n + o(x^n))  \\
                                                 & = -1 - 3x - 3x^2 - 4x^3 - 4x^4 - \dots - 4x^n + o(x^n)
              \end{align*}
        \item \begin{align*}
                  y & = \frac{1-\cos 2x}{2} = \frac{1}{2} - \frac{1}{2}\left(1 - \frac{(2x)^2}{2!} + \frac{(2x)^4}{4!} - \frac{(2x)^6}{6!} + \dots + (-1)^n \frac{(2x)^{2n}}{(2n)!} + o(x^{2n})\right) a \\
                    & = x^2 - \frac{1}{3}x^4 + \frac{2}{45}x^6 + \cdots + (-1)^n \frac{2^{2n-1}}{(2n)!} x^{2n} + o(x^{2n}).
              \end{align*}
    \end{enumerate}
\end{solution}

\begin{exercise}[3.6.2]
    求出函数 $\mathrm{e}^{\sin x}$ 的（具有 Peano 余项的）三阶 Maclaurin 展开式.
\end{exercise}

\begin{exercise}[3.6.3]
    求出函数 $\ln(\cos x)$ 的（具有 Peano 余项的）六阶 Maclaurin 展开式.
\end{exercise}

\begin{solution}
    \begin{align*}
        \ln(\cos x) & = \ln(1 + (\cos x - 1))                                                                                                                                                                                                          \\
                    & = (\cos x - 1) - \frac{(\cos x - 1)^2}{2} + \frac{(\cos x - 1)^3}{3} + o((\cos x - 1)^3)                                                                                                                                         \\
                    & = \left(-\frac{1}{2}x^2 + \frac{1}{4!}x^4 - \frac{1}{6!}x^6 + o(x^6)\right) - \frac{1}{2}\left(-\frac{1}{2}x^2 + \frac{1}{4!}x^4 + o(x^4)\right)^2 + \frac{1}{3}\left(-\frac{1}{2}x^2 + o(x^2)\right)^3 + o(x^6)                 \\
                    & = -\frac{1}{2}x^2 + \left(\frac{1}{4!} - \frac{1}{2}\left(\frac{1}{4}\right)\right)x^4 + \left(-\frac{1}{6!} + \frac{1}{2}\left(2 \cdot \frac{1}{2} \cdot \frac{1}{4!}\right) - \frac{1}{3} \cdot \frac{1}{8}\right)x^6 + o(x^6) \\
                    & = -\frac{1}{2}x^2 + \left(\frac{1}{24} - \frac{1}{8}\right)x^4 + \left(-\frac{1}{720} + \frac{1}{48} - \frac{1}{24}\right)x^6 + o(x^6)                                                                                           \\
                    & = -\frac{1}{2}x^2 - \frac{1}{12}x^4 - \frac{1}{45}x^6 + o(x^6)
    \end{align*}
\end{solution}

\begin{exercise}[3.6.4]
    已知 $f(x)$ 是一个四次多项式, 并且 $f(2) = -1, f'(2) = 0, f''(2) = 2, f'''(2) = -12, f^{(4)}(2) = 24$. 计算 $f(-1), f'(0), f''(1)$.
\end{exercise}

\begin{solution}
    \begin{align*}
        f(x) & = f(2) + f'(2)(x - 2) + \frac{f''(2)}{2!}(x - 2)^2 + \frac{f'''(2)}{3!}(x - 2)^3 + \frac{f^{(4)}(2)}{4!}(x - 2)^4 \\
             & = -1 + (x - 2)^2 - 2(x - 2)^3 + (x - 2)^4
    \end{align*}
    因此$$f(-1) = 143, f'(0) = -60, f''(1) = 26.$$
\end{solution}

\begin{exercise}[3.6.5]
    求下列函数具有 Lagrange 余项的 Taylor 公式.
    \begin{tasks}(2)
        \task $y = \tan x$ \text{在} $x = 0$ \text{的二阶} Taylor \text{展开式};
        \task $y = \frac{1}{x}$ \text{在} $x = -1$ \text{的} $n$ \text{阶} Taylor \text{展开式}.
    \end{tasks}
\end{exercise}

\begin{exercise}[3.6.6]
    求下列极限.
    \begin{tasks}(2)
        \task $\displaystyle \lim_{x \to 0} \frac{\cos x - \mathrm{e}^{-\frac{1}{2}x^2}}{\sin^4 x}$;
        \task $\displaystyle \lim_{x \to 0} \frac{\sqrt{1 + x^2} - \sqrt[3]{1 - x^2}}{x^2}$;
        \task $\displaystyle \lim_{x \to +\infty} \left[x - x^2 \ln \left(1 + \frac{1}{x}\right)\right]$;
        \task $\displaystyle \lim_{x \to 0} \frac{\cos(\sin x) - \cos x}{\sin^4 x}$.
    \end{tasks}
\end{exercise}

\begin{solution}
    \begin{enumerate}
        \item $$\cos x = 1 - \frac{1}{2}x^2 + \frac{1}{24}x^4 + o(x^4), \quad \mathrm{e}^{-\frac{1}{2}x^2} = 1 - \frac{1}{2}x^2 + \frac{1}{8}x^4 + o(x^4)$$
              因此$$\lim_{x \to 0} \frac{\cos x - \mathrm{e}^{-\frac{1}{2}x^2}}{\sin^4 x} = \lim_{x \to 0} \frac{\left(1 - \frac{1}{2}x^2 + \frac{1}{24}x^4 + o(x^4)\right) - \left(1 - \frac{1}{2}x^2 + \frac{1}{8}x^4 + o(x^4)\right)}{x^4 + o(x^4)} = -\frac{1}{12}.$$
        \item $$\sqrt{1 + x^2} = 1 + \frac{1}{2}x^2 - \frac{1}{8}x^4 + o(x^4), \quad \sqrt[3]{1 - x^2} = 1 - \frac{1}{3}x^2 - \frac{1}{9}x^4 + o(x^4)$$
              因此$$\lim_{x \to 0} \frac{\sqrt{1 + x^2} - \sqrt[3]{1 - x^2}}{x^2} = \lim_{x \to 0} \frac{\left(1 + \frac{1}{2}x^2 - \frac{1}{8}x^4 + o(x^4)\right) - \left(1 - \frac{1}{3}x^2 - \frac{1}{9}x^4 + o(x^4)\right)}{x^2} = \frac{5}{6}.$$
        \item \begin{align*}
                  \lim_{x \to \infty} \left[x - x^2 \ln \left(1 + \frac{1}{x}\right)\right] & = \lim_{x \to \infty} \left[x - x^2 \left(\frac{1}{x} - \frac{1}{2x^2} + o\left(\frac{1}{x^2}\right)\right)\right] \\
                                                                                            & = \lim_{x \to \infty} \left[x - \left(x - \frac{1}{2} + o(1)\right)\right]                                         \\
                                                                                            & = \lim_{x \to \infty} \left[\frac{1}{2} - o(1)\right] = \frac{1}{2}
              \end{align*}
        \item \begin{align*}
                  \cos(\sin x) & = 1 - \frac{(\sin x)^2}{2} + \frac{(\sin x)^4}{24} + o((\sin x)^4)                                                          \\
                               & = 1 - \frac{1}{2}\left(x - \frac{x^3}{6} + o(x^3)\right)^2 + \frac{1}{24}\left(x - \frac{x^3}{6} + o(x^3)\right)^4 + o(x^4) \\
                               & = 1 - \frac{1}{2}\left(x^2 - \frac{1}{3}x^4 + o(x^4)\right) + \frac{1}{24}\left(x^4 + o(x^4)\right) + o(x^4)                \\
                               & = 1 - \frac{1}{2}x^2 + \frac{1}{6}x^4 + \frac{1}{24}x^4 + o(x^4)                                                            \\
                               & = 1 - \frac{1}{2}x^2 + \frac{5}{24}x^4 + o(x^4)
              \end{align*}
              因此$$\lim_{x \to 0} \frac{\cos(\sin x) - \cos x}{\sin^4 x} = \lim_{x \to 0} \frac{\left(1 - \frac{1}{2}x^2 + \frac{5}{24}x^4 + o(x^4)\right) - \left(1 - \frac{1}{2}x^2 + \frac{1}{24}x^4 + o(x^4)\right)}{x^4 + o(x^4)} = \frac{1}{6}.$$

    \end{enumerate}
\end{solution}

\begin{exercise}[3.6.7]
    设函数 $f(x)$ 处处有 $n + 1$ 阶导数, 证明: $f(x)$ 为次数不超过 $n$ 的多项式的充分必要条件 是 $f^{(n+1)}(x) \equiv 0$.
\end{exercise}

\begin{exercise}[3.6.8]
    设函数 $f'(x)$ 在 $[0, 2]$ 上二阶可导, 且对任意 $x \in [0, 2]$, 有 $|f(x)| \les 1$ 及 $|f''(x)| \les 1$. 证明: $|f'(x)| \les 2, x \in [0, 2]$.
\end{exercise}

\begin{exercise}[3.6.9]
    设 $n$ 为自然数, 考虑函数 $f(x) = \begin{cases} x^{n+1}, & x \text{为有理数}, \\ 0, & x \text{为无理数}. \end{cases}$ 证明: $f'(0) = 0$, 但 $f''(0)$ 不存在.

    (提示: 证明 $f(x)$ 仅在一点 $x=0$ 可导.)

    注意, 我们显然有
    $$f(x) = 0 + 0 \cdot x + 0 \cdot x^2 + \dots + 0 \cdot x^n + o(x^n), \quad x \to 0.$$

    但当 $n > 1$ 时, 并不能断言 $f^{(k)}(0) = 0 (2 \les k \les n)$. 因此, 定理 3.32 中的条件: 函数在点 $x_0$ 处有 $n$ 阶导数, 是至关重要的.
\end{exercise}

\begin{exercise}[3.6.10]
    考虑函数 $f(x) = \begin{cases} \mathrm{e}^{-\frac{1}{x^2}}, & x \ne 0, \\ 0, & x = 0. \end{cases}$ 它在 $x \ne 0$ 处显然有任意阶导数. 证明: $f(x)$ 在 $x=0$ 处的任意阶导数都存在, 而且都等于零.
    (\text{提示}: 首先, 易用数学归纳法证明, 当 $x \ne 0$ 时, 对 $n=1, 2, \dots$ 有 $f^{(n)}(x) = \mathrm{e}^{-\frac{1}{x^2}} P_{3n}(\frac{1}{x})$, 这里 $P_{3n}(t)$ 是 $t$ 的 $3n$ 次多项式; 其次, 由导数定义及 L'Hôspital 法则, 得出 (\text{记} $y = \frac{1}{x}$)
    $$\lim_{x \to 0} \frac{f(x) - f(0)}{x} = \lim_{x \to 0} \frac{\mathrm{e}^{-\frac{1}{x^2}}}{x} = \lim_{y \to \infty} \frac{y}{\mathrm{e}^{y^2}} = \lim_{y \to \infty} \frac{1}{2y \mathrm{e}^{y^2}} = 0,$$
    即 $f'(0) = 0$. 现在, 说的结论易用数学归纳法及 L'Hôspital 法则证明.)

    本题意味着, 对任意的自然数 $n$, 函数 $f$ 在 $x=0$ 处的 $n$ 阶 Taylor 多项式是 $0$; 换句话说, 余项总是等于 $f(x)$. 因此, 即使函数在一点附近的性态, 用 (在该点的) 足够高阶的导数也未必能将其揭示出来.
\end{exercise}

\begin{exercise}[3.6.11]
    设函数 $f(x)$ 在驻点 $x_0$ 处的 $n$ 阶微商存在, 并且
    $$f'(x_0) = f''(x_0) = \dots = f^{(n-1)}(x_0) = 0, \quad \text{而 } f^{(n)}(x_0) \ne 0.$$

    证明:
    \begin{enumerate}
        \item 若 $n$ 为奇数, 则函数 $f(x)$ 在点 $x_0$ 处无极值;
        \item 若 $n$ 为偶数, 则函数 $f(x)$ 在点 $x_0$ 处取得极值. 当 $f^{(n)}(x_0) > 0$ 时, $f(x)$ 在点 $x_0$ 处取极小值; 当 $f^{(n)}(x_0) < 0$ 时, $f(x)$ 在点 $x_0$ 处取极大值.
    \end{enumerate}
    本题表明, 若函数 $f(x)$ 在驻点上存在如上所述的高阶导数, 则由此可确定驻点是否为极值点. 然而, 我们注意, 上一题中的函数 $f$ 在 $x=0$ 处显然有极小值, 但却不能用这一判别法判别.
\end{exercise}

\newpage
\section{第 3 章综合习题}

\begin{exercise}[3.C.1]
    设 $f(x) = x(x+1)(x+2)\dots(x+n)$, 求 $f'(0)$.
\end{exercise}

\begin{solution}
    \begin{align*}
        f'(0) & = \lim_{x \to 0} \frac{f(x) - f(0)}{x} = \lim_{x \to 0} \frac{x(x+1)(x+2)\dots(x+n)}{x} \\
              & = \lim_{x \to 0} (x+1)(x+2)\dots(x+n) = 1 \cdot 2 \cdot 3 \cdots n = n!.
    \end{align*}
\end{solution}

\begin{exercise}[3.C.2]
    设奇函数 $f(x)$ 在 $(-\infty, +\infty)$ 上具有二阶连续导数, 记函数
    $$g(x) = \begin{cases} \frac{f(x)}{x}, & x \ne 0, \\ a, & x = 0. \end{cases}$$
    \begin{enumerate}
        \item 确定 $a$ 的值, 使 $g(x)$ 在 $(-\infty, +\infty)$ 上连续.
        \item 对 (1) 中确定的 $a$, 证明: $g(x)$ 在 $(-\infty, +\infty)$ 上可导, 且导函数连续.
    \end{enumerate}
\end{exercise}

\begin{solution}
    \begin{enumerate}
        \item 由于 $f(x)$ 是奇函数, 故 $f(0) = 0 \Rightarrow g(0) = a = \lim_{x \to 0} \frac{f(x)}{x} = f'(0)$.
        \item \begin{align*}
                  g'(0) & = \lim_{x \to 0} \frac{g(x) - g(0)}{x - 0} = \lim_{x \to 0} \frac{\frac{f(x)}{x} - f'(0)}{x} = \lim_{x \to 0} \frac{f(x) - f'(0) x}{x^2} = \frac{f''(0)}{2}, \\
                  g'(x) & = \frac{f'(x) \cdot x - f(x)}{x^2}, \quad x \ne 0.
              \end{align*}
              又$$\lim_{x \to 0} g'(x) = \lim_{x \to 0} \frac{f'(x) \cdot x - f(x)}{x^2} = \lim_{x\to 0} \frac{f''(x) \cdot x + f'(x) - f'(x)}{2x} = \lim_{x \to 0} \frac{f''(x)}{2} = \frac{f''(0)}{2} = g'(0).$$
              因此, $g'(x)$ 在 $(-\infty, +\infty)$ 上连续.
    \end{enumerate}
\end{solution}

\begin{exercise}[3.C.3]
    设 $\frac{a_0}{n+1} + \frac{a_1}{n} + \dots + a_n = 0$, 证明: 方程 $a_0 x^n + a_1 x^{n-1} + \dots + a_n = 0$ 在 $(0, 1)$ 内至少有一个根.
\end{exercise}

\begin{solution}
    设函数 $f(x) = \frac{a_0}{n+1} x^{n+1} + \frac{a_1}{n} x^{n-1} + \dots + a_n x$. 则 $f(0) = 0$, 且
    $$f(1) = \frac{a_0}{n+1} + \frac{a_1}{n} + \dots + a_n = 0.$$
    由 Rolle 定理, 存在 $\xi \in (0, 1)$, 使得 $f'(\xi) = 0$,即
    $$a_0 \xi^{n-1} + a_1 \xi^{n-2} + \dots + a_{n-1} = 0.$$
\end{solution}

\begin{exercise}[3.C.4]
    若函数 $f(x)$ 在 $[a, b]$ 上连续, 在 $(a, b)$ 内可微, 且 $f(a) = f(b) = 0$, 证明: 存在 $\xi \in (a, b)$, 使 $f'(\xi) + f(\xi) = 0$.
\end{exercise}

\begin{solution}
    设函数 $g(x) = \mathrm{e}^x f(x)$, 则 $g(a) = g(b) = 0$. 由 Rolle 定理, 存在 $\xi \in (a, b)$, 使得
    $$g'(\xi) = \mathrm{e}^\xi f'(\xi) + \mathrm{e}^\xi f(\xi) = \mathrm{e}^\xi (f'(\xi) + f(\xi)) = 0.$$
    因为 $\mathrm{e}^\xi \ne 0$, 故 $f'(\xi) + f(\xi) = 0$.
\end{solution}

\begin{exercise}[3.C.5]
    设 $f(x)$ 在区间 $I$ 上连续, 如果任给 $I$ 中两点 $x_1, x_2$, 有
    $$f\left(\frac{x_1 + x_2}{2}\right) \les \frac{f(x_1) + f(x_2)}{2},$$
    证明: $f(x)$ 是区间 $I$ 上的凸函数.
\end{exercise}

我们将此习题完整表示为以下定理:
\begin{theorem*}
    设$f(x)$在$I$上有定义,若$\forall x_1,x_2 \in I$,以下三式等价:
    \begin{align}
        f\left(\lambda_1 x_1 + \lambda_2 x_2\right) & \les \lambda_1 f(x_1) + \lambda_2 f(x_2) , \quad \forall \lambda_1,\lambda_2 \in (0,1) , \lambda_1+\lambda_2 = 1 \tag{A} \\
        f\left( \frac{x_1+x_2}2 \right)             & \les \frac{f(x_1)+f(x_2)}2 \tag{B}                                                                                       \\
        f\left( \frac{x_1+x_2+\cdots+x_n}n \right)  & \les \frac{f(x_1)+f(x_2)+\cdots+f(x_n)}n , \quad \forall n \in \N \tag{C}
    \end{align}
\end{theorem*}
\begin{proof}
    我们使用向前和向后两步归纳法证明此定理.
    \begin{enumerate}
        \item 第一步我们先证明:
              式 (B) 成立 $\Rightarrow$ 式 (C) 成立.

              \begin{enumerate}
                  \item 由式 (B) 知式 (C) 当 $n=2$ 时成立. 现证 $n=4$ 时式 (C) 成立. 事实上, 对 $x_1, x_2, x_3, x_4 \in I$, 由式 (B), 我们有
                        \begin{align*}
                            f\left( \frac{x_1 + x_2 + x_3 + x_4}{4} \right) = f\left( \frac{\frac{x_1 + x_2}{2} + \frac{x_3 + x_4}{2}}{2} \right) & \les \frac{f\left( \frac{x_1 + x_2}{2} \right) + f\left( \frac{x_3 + x_4}{2} \right)}{2} \\
                                                                                                                                                  & \les \frac{f(x_1) + f(x_2) + f(x_3) + f(x_4)}{4}.
                        \end{align*}
                        此即式 (C) 对 $n=4$ 成立. 一般来说, 对任一自然数 $k$, 重复上面方法, 应用 (B) 式 $k$ 次, 可知
                        \[
                            f\left( \frac{x_1 + x_2 + \cdots + x_{2k}}{2^k} \right) \les \frac{f(x_1) + f(x_2) + \cdots + f(x_{2k})}{2^k}.
                        \]
                        这说明式 (C) 对一切 $n=2^k$ 皆成立.
                  \item 证明式 (C) 对 $n = k + 1$ 成立时,必对 $n = k$ 也成立.记
                        $A = \frac{x_1 + x_2 + \cdots + x_k}{k}$,则$x_1 + x_2 + \cdots + x_k = kA$,所以
                        $$A = \frac{x_1 + x_2 + \cdots + x_k + A}{k+1}.$$
                        因此式 (C) 对 $n = k + 1$ 成立, 故
                        \[
                            f(A) = \left( \frac{x_1 + x_2 + \cdots + x_k + A}{k+1} \right) \les \frac{f(x_1) + f(x_2) + \cdots + f(x_k) + f(A)}{k+1}.
                        \]

                        不等式两边同时乘以 $k + 1$, 减去 $f(A)$, 最后除以 $k$. 注意
                        \[
                            A = \frac{x_1 + x_2 + \cdots + x_k}{k},
                        \]

                        我们得到
                        \[
                            f\left( \frac{x_1 + x_2 + \cdots + x_k}{k} \right) \les \frac{f(x_1) + f(x_2) + \cdots + f(x_k)}{k}.
                        \]

                        此式表示式 (C) 对 $n = k$ 成立.
              \end{enumerate}
        \item 第二步我们证明:
              式 (C) 成立 $\Rightarrow$ 式 (A) 成立.

              \begin{enumerate}
                  \item 当$\lambda_1 =\frac{m}{n},\lambda_2 = \frac{n-m}{n}$为有理数时,
                        \begin{align*}
                            f\left(\lambda_1 x_1 + \lambda_2 x_2\right) & = f\left(\frac{m}{n}x_1 + \frac{n-m}{n}x_2\right)                \\
                                                                        & = f\left(\frac{x_1 + \cdots + x_1 + x_2 + \cdots + x_2}n\right)  \\
                                                                        & \les \frac{f(x_1) + \cdots + f(x_1) + f(x_2) + \cdots + f(x_2)}n \\
                                                                        & = \frac{m}{n}f(x_1) + \frac{n-m}{n}f(x_2).
                        \end{align*}
                  \item 当$\lambda_1,\lambda_2$为无理数时,由有理数的稠密性,存在$\lambda_n \to \lambda_1$,由$f$的连续性,有
                        \begin{align*}
                            f\left(\lambda_1 x_1 + \lambda_2 x_2\right) & = f\left(\lim_{n \to \infty} \lambda_n x_1 + (1-\lambda_n) x_2\right) \\
                                                                        & = \lim_{n \to \infty} f(\lambda_n x_1 + (1-\lambda_n) x_2)            \\
                                                                        & \les \lim_{n \to \infty} \lambda_n f(x_1) + (1-\lambda_n)f(x_2)       \\
                                                                        & = \lambda_1 f(x_1) + \lambda_2 f(x_2).
                        \end{align*}
              \end{enumerate}
    \end{enumerate}
\end{proof}

\begin{exercise}[3.C.6]
    设 $f(x)$ 是 $[0, 1]$ 上的二阶可微函数, $f(0) = f(1) = 0$. 证明: 存在 $\xi \in (0, 1)$, 使得
    $$f''(\xi) = \frac{2 f'(\xi)}{1 - \xi}.$$
\end{exercise}

\begin{solution}
    设函数$g(x) = (1-x)f(x)$, 则$g(0) = g(1) = 0$. 由 Rolle 定理, 存在$\eta \in (0,1)$,使得
    $$g'(\eta) = -f(\eta) + (1-\eta) f'(\eta) = 0$$
    同时$g'(1) = -f(1) + (1-1)f'(1) = 0$. 再次应用 Rolle 定理, 存在$\xi \in (\eta, 1) \subset (0,1)$,使得
    $$g''(\xi) = -2 f'(\xi) + (1-\xi) f''(\xi) = 0.$$
    故
    $$f''(\xi) = \frac{2 f'(\xi)}{1 - \xi}.$$
\end{solution}

\begin{exercise}[3.C.7]
    若函数 $f(x)$ 在 $[a, b]$ 上连续, 且 $f(a) = f(b) = 0$, $f'(a)f'(b) > 0$. 证明: 在 $(a, b)$ 内存在一点 $\xi$, 使得 $f(\xi) = 0$.
\end{exercise}

\begin{solution}
    不妨设 $f'(a) > 0, f'(b) > 0$. 则由$$f'(a) = \lim_{x \to a^+} \frac{f(x) - f(a)}{x - a} > 0,$$知存在$\delta_1 > 0$,使得当$x \in (a, a + \delta_1)$时,$f(x) > 0$. 同理,由$$f'(b) = \lim_{x \to b^-} \frac{f(x) - f(b)}{x - b} > 0,$$知存在$\delta_2 > 0$,使得当$x \in (b - \delta_2, b)$时,$f(x) < 0$. 令$\delta = \min\left\{\delta_1, \delta_2, \frac{b-a}{2}\right\}$,则$f(a + \delta) > 0,f(b - \delta) < 0$. 由介值定理,存在$\xi \in (a + \delta, b - \delta) \subset (a, b)$,使得$f(\xi) = 0$.
\end{solution}

\begin{exercise}[3.C.8]
    设 $f(x)$ 在 $[0, 1]$ 上可导, $f(0) = 1, f(1) = \frac{1}{2}$. 求证: 存在 $\xi \in (0, 1)$, 使得
    $$f^2(\xi) + f'(\xi) = 0.$$
\end{exercise}

\begin{solution}

    \begin{enumerate}
        \item 若$f(x) > 0$在$[0,1]$上成立,则设函数$g(x) = x - \frac{1}{f(x)}$, 则$g(0) = -1, g(1) = 1 - 2 = -1$. 由 Rolle 定理, 存在$\xi \in (0,1)$,使得
              $$g'(\xi) = 1 + \frac{f'(\xi)}{f^2(\xi)} = 0.$$
              故
              $$f^2(\xi) + f'(\xi) = 0.$$
        \item 若$f(x) > 0 $在$[0,1]$上不成立,考虑$x_0:=\inf\{x:f(x)=0\}$,则$f(x_0) = 0$.这是因为$x_0 = \inf\{x:f(x)=0\} \Rightarrow \exists \{x_n\},x_n \to x_0,f(x_n) = 0$,由$f$的连续性可知$f(x_0) = 0$.

              此时作以下分类:
              \begin{enumerate}
                  \item 若$f'(x_0) = 0$,则$f^2(x_0) + f'(x_0) = 0$成立.
                  \item 若$f'(x_0) > 0 $,则存在$\delta > 0$,使得当$x \in (x_0 - \delta, x_0 + \delta)$时,$f'(x) > 0$,所以$f$在$(x_0 - \delta, x_0 + \delta)$上单调递增.又$f(x_0) = 0$,所以当$x \in (x_0 - \delta, x_0)$时,$f(x) < 0$.这与$x_0 = \inf\{x:f(x)=0\}$矛盾.
                  \item 若$f'(x_0) < 0 $,再考虑$f(x)$在$[x_0,1]$上的极小值点$y_0<0$,有
                        $$f^2(x_0) + f'(x_0) = f'(x_0) < 0,$$
                        $$f^2(y_0) + f'(y_0) = f^2(y_0) \ges 0.$$
                        \begin{remark}
                            我希望对$f^2(x) + f'(x)$这个函数应用介值性,但是我们只知道$f(x)$可导,且不能直接说$f(x)$的连续性,加$f'(x)$的介值性得到$f^2(x) + f'(x)$的介值性.所以只好这么别扭的构造如下的$h(x)$.
                        \end{remark}

                        考虑$h(x) = \e^{\int_0^x f(t) \dif t}f(x)$,则$h'(x) = \e^{f(x)}(f^2(x) + f'(x))$.因此$h'(x_0) < 0,h'(y_0) \ges 0$.由 Darboux 定理,存在$\xi \in (x_0,y_0) \subset (0,1)$,使得$h'(\xi) = 0$,即
                        $$f^2(\xi) + f'(\xi) = 0.$$
              \end{enumerate}
    \end{enumerate}
\end{solution}

\begin{exercise}[3.C.9]
    设函数 $f(x)$ 在 $[a, +\infty)$ 上二阶可微, 且满足 $f(a) > 0, f'(a) < 0$, 以及当 $x > a$ 时, $f''(x) \les 0$. 试证在区间 $(a, +\infty)$ 内, 函数 $f(x)$ 恰有一个零点.
\end{exercise}

\begin{solution}
    若无零点,取$x > a - \frac{f(a)}{f'(a)}$,则由拉格朗日中值定理知,存在$\xi \in (a,x)$,使得
    $$f'(\xi) = \frac{f(x) - f(a)}{x - a} > \frac{-f(a)}{x - a} > f'(a),$$
    这与$f''(x) \les 0$矛盾.

    若有两个零点,记为$x_1 < x_2$,则由拉格朗日中值定理知,存在$\eta \in (x_1,x_2)$,使得
    $$f'(\eta) = \frac{f(x_2) - f(x_1)}{x_2 - x_1} = 0 > f'(a),$$
    这与$f''(x) \les 0$矛盾.
\end{solution}

\begin{exercise}[3.C.10]
    设函数 $f(x)$ 在 $[a, b]$ 上可导, $f'(x)$ 严格单调增. 若 $f(a) = f(b) = \lambda$, 证明: 对任意 $x \in (a, b)$, 有 $f(x) < \lambda$.
\end{exercise}

\begin{solution}
    由课本定理3.28 , $f'(x)$ 严格单调增, 故为严格凸函数. 由 Jensen 不等式, 对任意 $x \in (a, b)$, 有
    $$f(x) = f\left(\frac{b - x}{b - a} a + \frac{x - a}{b - a} b\right) < \frac{b - x}{b - a} f(a) + \frac{x - a}{b - a} f(b) = \lambda.$$
\end{solution}

\begin{exercise}[3.C.11]
    函数 $\frac{\sin x^2}{x} (x > 0)$ 表明, 若函数 $f(x)$ 在 $(a, +\infty)$ 上可导, 且 $\lim_{x \to +\infty} f(x)$ 存在, 不能保证 $\lim_{x \to +\infty} f'(x)$ 存在. 证明: 若已知该极限存在, 则其值必然为零.
\end{exercise}

\begin{solution}
    由L'Hôpital法则,已知$\lim_{x \to +\infty} f'(x)$存在,则
    $\lim_{x \to +\infty} \frac{f(x)}{x}$存在且等于$\lim_{x \to +\infty} f'(x)$.又因为$\lim_{x \to +\infty} f(x)=L$存在,所以
    $$\lim_{x \to +\infty} \frac{f(x)}{x} = \lim_{x \to +\infty} \frac{L}{x} = 0.$$
    因此$\lim_{x \to +\infty} f'(x) = 0$.
\end{solution}

\begin{exercise}[3.C.12]
    设函数 $f(x)$ 在 $x > 0$ 时二阶可微, 且 $f''(x) < 0, f(0) = 0$. 证明: 对任意正数 $x_1, x_2$, 有 $f(x_1 + x_2) < f(x_1) + f(x_2)$.
\end{exercise}

\begin{solution}
    由Lagrange中值定理,存在$\xi_1 \in (0,x_1), \xi_2 \in (x_1, x_1 + x_2)$,使得
    $$f'(\xi_1) = \frac{f(x_1) - f(0)}{x_1}, \quad f'(\xi_2) = \frac{f(x_1 + x_2) - f(x_2)}{x_1}.$$
    由题设$f''(x) < 0$,知$f'(x)$严格单调减,且$\xi_1 < \xi_2$,故$f'(\xi_1) > f'(\xi_2)$,即
    $$\frac{f(x_1) - f(0)}{x_1} > \frac{f(x_1 + x_2) - f(x_2)}{x_1}.$$
    整理即得.
\end{solution}

\begin{exercise}[3.C.13]
    设函数 $f(x)$ 在 $x_0$ 处存在二阶导数, 求
    $$\lim_{h \to 0} \frac{f(x_0 + h) + f(x_0 - h) - 2f(x_0)}{h^2}.$$
\end{exercise}
\begin{remark}
    不能使用L'Hôpital法则,因为缺定理条件.
\end{remark}
\begin{solution}
    \begin{align*}
          & \lim_{h \to 0} \frac{f(x_0 + h) + f(x_0 - h) - 2f(x_0)}{h^2}                                                                  \\
        = & \lim_{h \to 0}
        \frac{f(x_0) + f'(x_0) h + \frac{f''(x_0)}{2} h^2 + o(h^2) + f(x_0) - f'(x_0) h + \frac{f''(x_0)}{2} h^2 + o(h^2) - 2f(x_0)}{h^2} \\
        = & \lim_{h \to 0} \frac{f''(x_0) h^2 + o(h^2)}{h^2} = f''(x_0).
    \end{align*}
\end{solution}



\begin{exercise}[3.C.14]
    证明下列不等式.
    \begin{enumerate}
        \item 对任意实数 $x$, $\mathrm{e}^x \ges 1 + x + \frac{x^2}{2} + \frac{x^3}{6}$;
        \item 对 $x > 0$, $x - \frac{x^2}{2} \les \ln(1 + x) \les x - \frac{x^2}{2} + \frac{x^3}{3}$;
        \item 对 $0 < x < \frac{\pi}{2}$, $x - \frac{x^3}{6} < \sin x < x - \frac{x^3}{6} + \frac{x^5}{120}$;
        \item 对任意实数 $x, y$, 有 $2 \mathrm{e}^{\frac{x+y}{2}} \les \mathrm{e}^x + \mathrm{e}^y$.
    \end{enumerate}
\end{exercise}

\begin{solution}
    \begin{enumerate}
        \item $$\e^x = 1 + x + \frac{x^2}{2} + \frac{x^3}{6} + \frac{\e^\xi}{24} x^4 \ges 1 + x + \frac{x^2}{2} + \frac{x^3}{6}, \xi \in (0, x).$$
        \item \begin{align*}
            \ln(1+x) & = x - \frac{x^2}{2} + \frac{(1+\xi)^{-3}}{3} x^3 \ges x - \frac{x^2}{2}, \xi \in (0, x), \\
            \ln(1+x) & = x - \frac{x^2}{2} + \frac{x^3}{3} - \frac{(1+\eta)^{-4}}{4} x^4 \les x - \frac{x^2}{2} + \frac{x^3}{3}, \eta \in (0, x).
        \end{align*}
        \item \begin{align*}
            \sin x & = x - \frac{x^3}{6} + \frac{\cos \xi}{24} x^4 \ges x - \frac{x^3}{6}, \xi \in (0, x), \\
            \sin x & = x - \frac{x^3}{6} + \frac{x^5}{120} - \frac{\sin \eta}{720} x^6 \les x - \frac{x^3}{6} + \frac{x^5}{120}, \eta \in (0, x).
        \end{align*}
        \item 由$\e^x$为凸函数,以及Jensen不等式,知
              $$\e^{\frac{x+y}{2}} \les \frac{\e^x + \e^y}{2}.$$
    \end{enumerate}
\end{solution}

\begin{exercise}[3.C.15]
    求 $\displaystyle \lim_{n \to \infty} \left(1 + \frac{1}{n^2}\right) \left(1 + \frac{2}{n^2}\right) \dots \left(1 + \frac{n}{n^2}\right)$.
\end{exercise}

\begin{exercise}[3.C.16]
    求 $\sqrt[n]{n} (n=1, 2, \dots)$ 的最大值.
\end{exercise}

\begin{exercise}[3.C.17]
    试给出函数 $x \cos x$ 在 $[0, \frac{\pi}{2}]$ 上的一个尽可能小的上界.
\end{exercise}

\begin{exercise}[3.C.18]
    设函数 $f(x)$ 在闭区间 $[-1, 1]$ 上具有三阶连续导数, 且 $f(-1) = 0, f(1) = 1, f'(0) = 0$. 证明: 存在 $\xi \in (-1, 1)$, 使得 $f'''(\xi) = 3$.
\end{exercise}

\begin{exercise}[3.C.19]
    设 $a > 1$, 函数 $f: (0, +\infty) \to (0, +\infty)$ 可微. 求证: 存在趋于无穷的正数列 $\{x_n\}$, 使得
    $$f'(x_n) < f(a x_n), \quad n=1, 2, \dots$$
\end{exercise}

\begin{exercise}[3.C.20]
    利用凸函数的性质证明 Hölder (赫尔德) 不等式: 设 $a_i, b_i, i = 1, 2, \dots, n$ 是正数, $p, q$ 是大于 $1$ 的正数, 且 $\frac{1}{p} + \frac{1}{q} = 1$, 则有
    $$\sum_{i=1}^n a_i b_i \les \left(\sum_{i=1}^n a_i^p\right)^{\frac{1}{p}} \left(\sum_{i=1}^n b_i^q\right)^{\frac{1}{q}}.$$
    (提示: 考虑函数 $f(x) = x^p$.)
\end{exercise}